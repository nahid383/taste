<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Software Engineering Department - Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Login Page -->
    <div id="login-page" class="min-h-screen login-bg flex items-center justify-center px-6">
        <div class="max-w-4xl w-full">
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
                <div class="md:flex">
                    <!-- Image Section -->
                    <div class="md:w-1/2 bg-gray-200 flex items-center justify-center p-8">
                        <div class="text-center">
                            <!-- IICT Building Image -->
                            <div class="w-full h-64 bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg overflow-hidden mb-4">
                                <img src="iict.jpg" alt="IICT Building - Institute of Information & Communication Technology" 
                                     class="w-full h-full object-cover"
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="w-full h-full bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg flex items-center justify-center" style="display: none;">
                                    <div class="text-center">
                                        <div class="text-6xl mb-4">üèõÔ∏è</div>
                                        <p class="text-gray-600 font-semibold">IICT Building</p>
                                        <p class="text-sm text-gray-500 mt-2">Institute of Information & Communication Technology</p>
                                    </div>
                                </div>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-800 mb-2">Welcome to</h2>
                            <h3 class="text-xl text-gray-600">Software Engineering Department</h3>
                        </div>
                    </div>
                    
                    <!-- Login Form Section -->
                    <div class="md:w-1/2 p-8">
                        <div class="text-center mb-8">
                            <h1 class="text-3xl font-bold text-gray-800 mb-2">Student Login</h1>
                            <p class="text-gray-600">Enter your details to access course materials</p>
                        </div>
                        
                        <form id="loginForm" class="space-y-6">
                            <div>
                                <label for="studentName" class="block text-sm font-medium text-gray-700 mb-2">
                                    Full Name
                                </label>
                                <input 
                                    type="text" 
                                    id="studentName" 
                                    name="studentName"
                                    required
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"
                                    placeholder="Enter your full name"
                                >
                            </div>
                            
                            <div>
                                <label for="registrationNumber" class="block text-sm font-medium text-gray-700 mb-2">
                                    Registration Number
                                </label>
                                <input 
                                    type="text" 
                                    id="registrationNumber" 
                                    name="registrationNumber"
                                    required
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"
                                    placeholder="e.g., 2021831001"
                                >
                            </div>
                            
                            <button 
                                type="submit"
                                class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105"
                            >
                                Access Course Materials
                            </button>
                        </form>
                        
                        <div class="mt-8 text-center">
                            <p class="text-sm text-gray-500">
                                Need help? Contact your department administrator
                            </p>
                            <p class="text-xs text-gray-400 mt-2">
                                This website is owned by SUST SWE-23
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application (Hidden Initially) -->
    <div id="main-app" class="hidden">
        <!-- Header -->
        <header class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 text-white shadow-lg">
            <div class="container mx-auto px-6 py-8">
                <div class="flex justify-between items-center mb-8">
                    <div class="text-right ml-auto">
                        <p class="text-lg">Welcome, <span id="welcomeName" class="font-semibold"></span></p>
                        <p class="text-sm opacity-75">Reg: <span id="welcomeReg"></span></p>
                        <button onclick="logout()" class="mt-2 bg-red-500 hover:bg-red-600 px-4 py-2 rounded-lg text-sm transition-colors mr-2">
                            Logout
                        </button>
                        <button onclick="showLogs()" class="mt-2 bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg text-sm transition-colors">
                            View Logs
                        </button>
                    </div>
                </div>
                
                <!-- Department Header -->
                <div class="text-center mb-8">
                    <h1 class="text-5xl md:text-7xl lg:text-8xl font-bold mb-6">Software Engineering Department</h1>
                    <p class="text-2xl md:text-3xl lg:text-4xl opacity-90">Excellence in Software Development Education</p>
                </div>
                
                <!-- Social Links -->
                <div class="flex justify-center space-x-6 mt-8">
                    <a href="https://www.facebook.com/swesocietysust" target="_blank" rel="noopener noreferrer" 
                       class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-semibold transition-colors duration-300 flex items-center space-x-2">
                        <span>üìò</span>
                        <span>Facebook Page</span>
                    </a>
                    <a href="https://www.sust.edu/institutes/IICT" target="_blank" rel="noopener noreferrer"
                       class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg font-semibold transition-colors duration-300 flex items-center space-x-2">
                        <span>üåê</span>
                        <span>Official Website</span>
                    </a>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container mx-auto px-6 py-12">
            <div id="main-view" class="fade-in">
                <h2 class="text-3xl font-bold text-center mb-12 text-gray-800">Academic Years</h2>
                
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- First Year -->
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="showYear(1)">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üéì</div>
                            <h3 class="text-2xl font-bold text-gray-800 mb-2">First Year</h3>
                            <p class="text-gray-600">Foundation Courses</p>
                            <div class="mt-4 text-sm text-gray-500">
                                <p>Semester 1: 18.0 Credits</p>
                                <p>Semester 2: 22.0 Credits</p>
                            </div>
                        </div>
                    </div>

                    <!-- Second Year -->
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="showYear(2)">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üíª</div>
                            <h3 class="text-2xl font-bold text-gray-800 mb-2">Second Year</h3>
                            <p class="text-gray-600">Core Programming</p>
                            <div class="mt-4 text-sm text-gray-500">
                                <p>Semester 1: 22.5 Credits</p>
                                <p>Semester 2: 19.5 Credits</p>
                            </div>
                        </div>
                    </div>

                    <!-- Third Year -->
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="showYear(3)">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üöÄ</div>
                            <h3 class="text-2xl font-bold text-gray-800 mb-2">Third Year</h3>
                            <p class="text-gray-600">Advanced Topics</p>
                            <div class="mt-4 text-sm text-gray-500">
                                <p>Semester 1: 20.5 Credits</p>
                                <p>Semester 2: 19.5 Credits</p>
                            </div>
                        </div>
                    </div>

                    <!-- Fourth Year -->
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="showYear(4)">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üèÜ</div>
                            <h3 class="text-2xl font-bold text-gray-800 mb-2">Fourth Year</h3>
                            <p class="text-gray-600">Specialization</p>
                            <div class="mt-4 text-sm text-gray-500">
                                <p>Semester 1: 19.5 Credits</p>
                                <p>Semester 2: 19.0 Credits</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Year View -->
            <div id="year-view" class="hidden fade-in">
                <div class="flex items-center mb-8">
                    <button onclick="showMain()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg mr-4 transition-colors duration-300">
                        ‚Üê Back
                    </button>
                    <h2 id="year-title" class="text-3xl font-bold text-gray-800"></h2>
                </div>
                
                <div id="semester-grid" class="grid md:grid-cols-2 gap-8">
                    <!-- Semesters will be populated here -->
                </div>
            </div>

            <!-- Semester View -->
            <div id="semester-view" class="hidden fade-in">
                <div class="flex items-center mb-8">
                    <button onclick="showYear(currentYear)" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg mr-4 transition-colors duration-300">
                        ‚Üê Back
                    </button>
                    <h2 id="semester-title" class="text-3xl font-bold text-gray-800"></h2>
                </div>
                
                <div id="courses-grid" class="grid gap-6">
                    <!-- Courses will be populated here -->
                </div>
            </div>

            <!-- Course View -->
            <div id="course-view" class="hidden fade-in">
                <div class="flex items-center mb-8">
                    <button onclick="showSemester(currentYear, currentSemester)" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg mr-4 transition-colors duration-300">
                        ‚Üê Back
                    </button>
                    <h2 id="course-title" class="text-3xl font-bold text-gray-800"></h2>
                </div>
                
                <div id="course-materials" class="grid md:grid-cols-3 gap-8">
                    <!-- Course materials will be populated here -->
                </div>
            </div>

            <!-- Logs View -->
            <div id="logs-view" class="hidden fade-in">
                <div class="flex items-center justify-between mb-8">
                    <div class="flex items-center">
                        <button onclick="showMain()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg mr-4 transition-colors duration-300">
                            ‚Üê Back
                        </button>
                        <h2 class="text-3xl font-bold text-gray-800">User Activity Logs</h2>
                    </div>
                    <div class="flex space-x-4">
                        <button onclick="UserLogger.exportLogs()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                            üì• Export CSV
                        </button>
                        <button onclick="clearLogs()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors">
                            üóëÔ∏è Clear Logs
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="mb-4 flex justify-between items-center">
                        <div class="flex space-x-4">
                            <input type="text" id="logSearch" placeholder="Search logs..." 
                                   class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <select id="logFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">All Activities</option>
                                <option value="login">Login</option>
                                <option value="logout">Logout</option>
                                <option value="navigation">Navigation</option>
                                <option value="course_access">Course Access</option>
                                <option value="file_access">File Access</option>
                            </select>
                        </div>
                        <div class="text-sm text-gray-600">
                            Total Logs: <span id="logCount">0</span>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left font-medium text-gray-700">Timestamp</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-700">User</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-700">Registration</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-700">Action</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-700">Details</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-700">Course</th>
                                </tr>
                            </thead>
                            <tbody id="logsTableBody" class="divide-y divide-gray-200">
                                <!-- Logs will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        let currentYear = 1;
        let currentSemester = 1;
        let currentCourse = '';

        const curriculum = {
            1: {
                1: [
                    { code: 'SWE0613-1121', name: 'Structured Programming Language', credits: 3.0 },
                    { code: 'SWE0613-1122', name: 'Structured Programming Language Lab', credits: 1.5 },
                    { code: 'SWE0541-1123', name: 'Discrete Mathematics', credits: 3.0 },
                    { code: 'EEE0712-1101W', name: 'Basic Electrical and Electronic Circuits', credits: 3.0 },
                    { code: 'EEE0712-1102W', name: 'Basic Electrical and Electronic Circuits Lab', credits: 1.5 },
                    { code: 'MAT0541-1105W', name: 'Coordinate Geometry and Calculus', credits: 3.0 },
                    { code: 'ENG0231-1101W', name: 'Effective Communication in English', credits: 2.0 },
                    { code: 'ENG0231-1102W', name: 'English Language Lab 1', credits: 1.0 }
                ],
                2: [
                    { code: 'SWE0613-1225', name: 'Introduction to Software Engineering', credits: 3.0 },
                    { code: 'SWE0613-1227', name: 'Data Structure', credits: 3.0 },
                    { code: 'SWE0613-1228', name: 'Data Structure Lab', credits: 2.0 },
                    { code: 'PHY0533-1203W', name: 'Mechanics, Wave, Heat & Thermodynamics', credits: 3.0 },
                    { code: 'MAT0541-1207W', name: 'Linear and Abstract Algebra', credits: 3.0 },
                    { code: 'STA0542-1201W', name: 'Basic Statistics', credits: 3.0 },
                    { code: 'SOC0314-1203W', name: 'Sociology for Engineers', credits: 3.0 },
                    { code: 'SWE0610-1250', name: 'Project Work-I', credits: 2.0 }
                ]
            },
            2: {
                1: [
                    { code: 'SWE0613-2122', name: 'Introduction to Competitive Programming', credits: 2.0 },
                    { code: 'SWE0613-2123', name: 'Object Oriented Programming', credits: 3.0 },
                    { code: 'SWE0613-2124', name: 'Object Oriented Programming Language Lab', credits: 2.0 },
                    { code: 'SWE0613-2125', name: 'Software Requirement Engineering', credits: 2.0 },
                    { code: 'SWE0613-2126', name: 'Software Requirement Engineering Lab', credits: 1.5 },
                    { code: 'CSE0613-2119W', name: 'Computer Architecture', credits: 3.0 },
                    { code: 'STA0542-2101W', name: 'Probability', credits: 3.0 },
                    { code: 'BUS0411-2101W', name: 'Cost and Management Accounting', credits: 3.0 },
                    { code: 'ECO0311-2105W', name: 'Principles of Economics', credits: 3.0 }
                ],
                2: [
                    { code: 'SWE0613-2227', name: 'Theory of Computation', credits: 2.0 },
                    { code: 'SWE0613-2229', name: 'Algorithm Design & Analysis', credits: 3.0 },
                    { code: 'SWE0613-2230', name: 'Algorithm Design & Analysis Lab', credits: 1.5 },
                    { code: 'SWE0541-2231', name: 'Numerical Analysis', credits: 2.0 },
                    { code: 'SWE0541-2232', name: 'Numerical Analysis Lab', credits: 1.5 },
                    { code: 'SWE0613-2233', name: 'Operating Systems and System Programming', credits: 3.0 },
                    { code: 'SWE0613-2234', name: 'Operating Systems and System Programming Lab', credits: 1.5 },
                    { code: 'SWE0488-2235', name: 'Ethics and Cyber Law', credits: 2.0 },
                    { code: 'SWE0688-2237', name: 'Management Information System', credits: 2.0 },
                    { code: 'SWE0610-2250', name: 'Project Work ‚ÄìII', credits: 2.0 }
                ]
            },
            3: {
                1: [
                    { code: 'SWE0613-3121', name: 'Software Architecture and Design Patterns', credits: 3.0 },
                    { code: 'SWE0613-3122', name: 'Software Architecture and Design Patterns Lab', credits: 1.5 },
                    { code: 'SWE0619-3123', name: 'Artificial Intelligence', credits: 3.0 },
                    { code: 'SWE0619-3124', name: 'Artificial Intelligence Lab', credits: 1.5 },
                    { code: 'SWE0612-3127', name: 'Database Management System', credits: 3.0 },
                    { code: 'SWE0612-3128', name: 'Database Management System Lab', credits: 2.0 },
                    { code: 'SWE0612-3130', name: 'Web Technologies', credits: 2.0 },
                    { code: 'CSE0612-3113W', name: 'Computer Networking', credits: 3.0 },
                    { code: 'CSE0612-3114W', name: 'Computer Networking Lab', credits: 1.5 }
                ],
                2: [
                    { code: 'SWE0612-3225', name: 'Distributed System', credits: 2.0 },
                    { code: 'SWE0612-3226', name: 'Distributed System Lab', credits: 1.5 },
                    { code: 'SWE0613-3231', name: 'Software Usability and Metrics', credits: 2.0 },
                    { code: 'SWE0613-3233', name: 'Software Verification and Validation', credits: 2.0 },
                    { code: 'SWE0613-3234', name: 'Software Verification and Validation Lab', credits: 1.5 },
                    { code: 'SWE0611-3242', name: 'Technical Writing And Presentation', credits: 2.0 },
                    { code: 'SWE0619-3243', name: 'Machine Learning', credits: 3.0 },
                    { code: 'SWE0619-3244', name: 'Machine Learning Lab', credits: 1.5 },
                    { code: 'BUS0414-3201W', name: 'Entrepreneurship Development', credits: 2.0 },
                    { code: 'SWE0610-3250', name: 'Project Work-III', credits: 2.0 }
                ]
            },
            4: {
                1: [
                    { code: 'SWE0613-4125', name: 'Software Project Management', credits: 2.0 },
                    { code: 'SWE0613-4126', name: 'Software Project Management Lab', credits: 1.0 },
                    { code: 'SWE0612-4129', name: 'Information and Network Security', credits: 2.0 },
                    { code: 'SWE0612-4130', name: 'Information and Network Security Lab', credits: 1.5 },
                    { code: 'SWE0688-4131', name: 'Human Computer Interaction', credits: 3.0 },
                    { code: 'SWE0688-4132', name: 'Human Computer Interaction Lab', credits: 1.5 },
                    { code: 'SWE06**', name: 'Option', credits: 3.0 },
                    { code: 'SWE06**', name: 'Option Lab', credits: 1.5 },
                    { code: 'SWE0610-4150', name: 'Thesis/Project', credits: 4.0 }
                ],
                2: [
                    { code: 'SWE0613-4220', name: 'Internship', credits: 18.0 },
                    { code: 'SWE0610-4160', name: 'Comprehensive Viva Voce', credits: 1.0 }
                ]
            }
        };

        // User activity logging system
        const UserLogger = {
            logs: [],
            
            // Initialize logging system
            init() {
                this.loadLogs();
                this.logActivity('system', 'Page loaded');
            },
            
            // Log user activity
            logActivity(action, details = '', courseCode = '') {
                const timestamp = new Date().toISOString();
                const userName = sessionStorage.getItem('studentName') || 'Anonymous';
                const userReg = sessionStorage.getItem('registrationNumber') || 'N/A';
                
                const logEntry = {
                    id: Date.now() + Math.random(),
                    timestamp,
                    userName,
                    userReg,
                    action,
                    details,
                    courseCode,
                    sessionId: this.getSessionId()
                };
                
                this.logs.push(logEntry);
                this.saveLogs();
                
                // Also log to console for debugging
                console.log('User Activity:', logEntry);
            },
            
            // Get or create session ID
            getSessionId() {
                let sessionId = sessionStorage.getItem('sessionId');
                if (!sessionId) {
                    sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    sessionStorage.setItem('sessionId', sessionId);
                }
                return sessionId;
            },
            
            // Save logs to localStorage
            saveLogs() {
                try {
                    localStorage.setItem('userActivityLogs', JSON.stringify(this.logs));
                } catch (e) {
                    console.warn('Could not save logs to localStorage:', e);
                }
            },
            
            // Load logs from localStorage
            loadLogs() {
                try {
                    const savedLogs = localStorage.getItem('userActivityLogs');
                    if (savedLogs) {
                        this.logs = JSON.parse(savedLogs);
                    }
                } catch (e) {
                    console.warn('Could not load logs from localStorage:', e);
                    this.logs = [];
                }
            },
            
            // Get logs for specific user
            getUserLogs(regNumber) {
                return this.logs.filter(log => log.userReg === regNumber);
            },
            
            // Get all logs (for admin view)
            getAllLogs() {
                return this.logs.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            },
            
            // Export logs as CSV
            exportLogs() {
                const headers = ['Timestamp', 'Name', 'Registration', 'Action', 'Details', 'Course Code', 'Session ID'];
                const csvContent = [
                    headers.join(','),
                    ...this.logs.map(log => [
                        log.timestamp,
                        `"${log.userName}"`,
                        log.userReg,
                        `"${log.action}"`,
                        `"${log.details}"`,
                        log.courseCode,
                        log.sessionId
                    ].join(','))
                ].join('\n');
                
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `user_activity_logs_${new Date().toISOString().split('T')[0]}.csv`;
                a.click();
                window.URL.revokeObjectURL(url);
            },
            
            // Clear old logs (keep last 1000 entries)
            cleanupLogs() {
                if (this.logs.length > 1000) {
                    this.logs = this.logs.slice(-1000);
                    this.saveLogs();
                }
            }
        };

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize logging system
            UserLogger.init();
            
            // Initialize login form
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const name = document.getElementById('studentName').value.trim();
                    const regNumber = document.getElementById('registrationNumber').value.trim();
                    
                    if (name && regNumber) {
                        // Store user info
                        sessionStorage.setItem('studentName', name);
                        sessionStorage.setItem('registrationNumber', regNumber);
                        
                        // Log login activity
                        UserLogger.logActivity('login', `User logged in: ${name} (${regNumber})`);
                        
                        // Show main app
                        document.getElementById('login-page').classList.add('hidden');
                        document.getElementById('main-app').classList.remove('hidden');
                        
                        // Update welcome message
                        document.getElementById('welcomeName').textContent = name;
                        document.getElementById('welcomeReg').textContent = regNumber;
                        
                        // Log main page access
                        UserLogger.logActivity('navigation', 'Accessed main dashboard');
                    }
                });
            }
            
            // Check if user is already logged in
            const name = sessionStorage.getItem('studentName');
            const regNumber = sessionStorage.getItem('registrationNumber');
            
            if (name && regNumber) {
                document.getElementById('login-page').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                document.getElementById('welcomeName').textContent = name;
                document.getElementById('welcomeReg').textContent = regNumber;
                
                // Log returning user
                UserLogger.logActivity('session_resume', `Returning user: ${name} (${regNumber})`);
            }
            
            // Cleanup old logs periodically
            UserLogger.cleanupLogs();
        });

        // Logout functionality
        function logout() {
            // Log logout activity before clearing session
            UserLogger.logActivity('logout', 'User logged out');
            
            sessionStorage.removeItem('studentName');
            sessionStorage.removeItem('registrationNumber');
            sessionStorage.removeItem('sessionId');
            
            document.getElementById('main-app').classList.add('hidden');
            document.getElementById('login-page').classList.remove('hidden');
            
            // Reset form
            document.getElementById('loginForm').reset();
            
            // Reset views
            showMain();
        }

        function showMain() {
            document.getElementById('main-view').classList.remove('hidden');
            document.getElementById('year-view').classList.add('hidden');
            document.getElementById('semester-view').classList.add('hidden');
            document.getElementById('course-view').classList.add('hidden');
        }

        function showYear(year) {
            currentYear = year;
            document.getElementById('main-view').classList.add('hidden');
            document.getElementById('year-view').classList.remove('hidden');
            document.getElementById('semester-view').classList.add('hidden');
            document.getElementById('course-view').classList.add('hidden');
            
            const yearNames = ['', 'First', 'Second', 'Third', 'Fourth'];
            document.getElementById('year-title').textContent = `${yearNames[year]} Year`;
            
            // Log navigation activity
            UserLogger.logActivity('navigation', `Viewed ${yearNames[year]} Year`);
            
            const semesterGrid = document.getElementById('semester-grid');
            semesterGrid.innerHTML = `
                <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="showSemester(${year}, 1)">
                    <div class="text-center">
                        <div class="text-5xl mb-4">üìñ</div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Semester 1</h3>
                        <p class="text-gray-600">${curriculum[year][1].length} Courses</p>
                        <div class="mt-4 text-sm text-gray-500">
                            <p>Total Credits: ${curriculum[year][1].reduce((sum, course) => sum + course.credits, 0)}</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="showSemester(${year}, 2)">
                    <div class="text-center">
                        <div class="text-5xl mb-4">üìö</div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Semester 2</h3>
                        <p class="text-gray-600">${curriculum[year][2].length} Courses</p>
                        <div class="mt-4 text-sm text-gray-500">
                            <p>Total Credits: ${curriculum[year][2].reduce((sum, course) => sum + course.credits, 0)}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function showSemester(year, semester) {
            currentYear = year;
            currentSemester = semester;
            document.getElementById('year-view').classList.add('hidden');
            document.getElementById('semester-view').classList.remove('hidden');
            document.getElementById('course-view').classList.add('hidden');
            
            const yearNames = ['', 'First', 'Second', 'Third', 'Fourth'];
            document.getElementById('semester-title').textContent = `${yearNames[year]} Year - Semester ${semester}`;
            
            // Log semester navigation
            UserLogger.logActivity('navigation', `Viewed ${yearNames[year]} Year - Semester ${semester}`);
            
            const coursesGrid = document.getElementById('courses-grid');
            const courses = curriculum[year][semester];
            
            let coursesHTML = courses.map(course => `
                <div class="bg-white rounded-xl shadow-lg p-6 card-hover cursor-pointer" onclick="showCourse('${course.code}', '${course.name}')">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-bold text-gray-800 mb-2">${course.name}</h3>
                            <p class="text-gray-600 text-sm mb-2">${course.code}</p>
                            <div class="flex items-center">
                                <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">
                                    ${course.credits} Credits
                                </span>
                            </div>
                        </div>
                        <div class="text-2xl ml-4">üìÑ</div>
                    </div>
                </div>
            `).join('');
            
            // Add year-wise question folders for First Year Semester 1
            if (year === 1 && semester === 1) {
                coursesHTML += `
                    <div class="col-span-full">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">Question Papers by Year</h3>
                        <div class="grid md:grid-cols-4 gap-4">
                            <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl shadow-lg p-6 card-hover cursor-pointer" onclick="openYearQuestions('2023')">
                                <div class="text-center">
                                    <div class="text-3xl mb-2">üìã</div>
                                    <h4 class="text-lg font-bold">2023</h4>
                                    <p class="text-sm opacity-90">Latest Questions</p>
                                </div>
                            </div>
                            
                            <div class="bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl shadow-lg p-6 card-hover cursor-pointer" onclick="openYearQuestions('2022')">
                                <div class="text-center">
                                    <div class="text-3xl mb-2">üìã</div>
                                    <h4 class="text-lg font-bold">2022</h4>
                                    <p class="text-sm opacity-90">Previous Year</p>
                                </div>
                            </div>
                            
                            <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl shadow-lg p-6 card-hover cursor-pointer" onclick="openYearQuestions('2021')">
                                <div class="text-center">
                                    <div class="text-3xl mb-2">üìã</div>
                                    <h4 class="text-lg font-bold">2021</h4>
                                    <p class="text-sm opacity-90">Archive</p>
                                </div>
                            </div>
                            
                            <div class="bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-xl shadow-lg p-6 card-hover cursor-pointer" onclick="openYearQuestions('2020')">
                                <div class="text-center">
                                    <div class="text-3xl mb-2">üìã</div>
                                    <h4 class="text-lg font-bold">2020</h4>
                                    <p class="text-sm opacity-90">Archive</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            coursesGrid.innerHTML = coursesHTML;
        }

        function showCourse(courseCode, courseName) {
            currentCourse = courseCode;
            document.getElementById('semester-view').classList.add('hidden');
            document.getElementById('course-view').classList.remove('hidden');
            
            document.getElementById('course-title').textContent = courseName;
            
            // Log course access
            UserLogger.logActivity('course_access', `Accessed course: ${courseName}`, courseCode);
            
            // Update course materials display - customize for lab courses
            const courseMaterials = document.getElementById('course-materials');
            
            if (currentCourse === 'EEE0712-1102W') {
                // Special layout for EEE Lab course with the three folders
                courseMaterials.innerHTML = `
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="openEEELabLink('lab-report')">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üìã</div>
                            <h3 class="text-xl font-bold text-gray-800">Lab Report</h3>
                            <p class="text-gray-600 mt-2">Lab Reports and Documentation</p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="openEEELabLink('class-slide')">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üìä</div>
                            <h3 class="text-xl font-bold text-gray-800">Class Slide</h3>
                            <p class="text-gray-600 mt-2">Presentation Materials</p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="openEEELabLink('pspice-workspace')">
                        <div class="text-center">
                            <div class="text-5xl mb-4">‚ö°</div>
                            <h3 class="text-xl font-bold text-gray-800">PSpice Workspace</h3>
                            <p class="text-gray-600 mt-2">Simulation Files and Projects</p>
                        </div>
                    </div>
                `;
            } else if (currentCourse === 'ENG0231-1102W') {
                // Special layout for English Language Lab with Assignment and Grammar folders
                courseMaterials.innerHTML = `
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="openEnglishLabLink('assignment')">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üìù</div>
                            <h3 class="text-xl font-bold text-gray-800">Assignment</h3>
                            <p class="text-gray-600 mt-2">Lab Assignments and Tasks</p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="openEnglishLabLink('grammar')">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üìñ</div>
                            <h3 class="text-xl font-bold text-gray-800">Grammar</h3>
                            <p class="text-gray-600 mt-2">Grammar Rules and Exercises</p>
                        </div>
                    </div>
                `;
            } else {
                // Regular layout for all other courses
                courseMaterials.innerHTML = `
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="openDriveLink('books')">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üìö</div>
                            <h3 class="text-xl font-bold text-gray-800">Books</h3>
                            <p class="text-gray-600 mt-2">Textbooks and References</p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="openDriveLink('notes')">
                        <div class="text-center">
                            <div class="text-5xl mb-4">üìù</div>
                            <h3 class="text-xl font-bold text-gray-800">Notes</h3>
                            <p class="text-gray-600 mt-2">Lecture Notes and Materials</p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-8 card-hover cursor-pointer" onclick="openDriveLink('questions')">
                        <div class="text-center">
                            <div class="text-5xl mb-4">‚ùì</div>
                            <h3 class="text-xl font-bold text-gray-800">Previous Questions</h3>
                            <p class="text-gray-600 mt-2">Past Exam Papers</p>
                        </div>
                    </div>
                `;
            }
        }

        function openEEELabLink(type) {
            const eeeLabLinks = {
                'lab-report': 'https://drive.google.com/drive/folders/1bIVcp3BoLEF_RQuBAlNTNtPdk2-89_eY?usp=drive_link',
                'class-slide': 'https://drive.google.com/drive/folders/10QOGp_8xOFkKHuTDZHqttRxYoxvVuU-R?usp=drive_link',
                'pspice-workspace': 'https://drive.google.com/drive/folders/1YoLn3jtVgj7ryvTMpG7FT34EU9E9iCKO?usp=drive_link'
            };
            
            if (eeeLabLinks[type]) {
                // Log file access
                UserLogger.logActivity('file_access', `Accessed EEE Lab ${type.replace('-', ' ')}`, currentCourse);
                window.open(eeeLabLinks[type], '_blank', 'noopener,noreferrer');
            }
        }

        function openEnglishLabLink(type) {
            const englishLabLinks = {
                'assignment': 'https://drive.google.com/drive/folders/1LUsjgvfxzvIbyYvIS8yiMzJ6zTaEVlhb?usp=drive_link',
                'grammar': 'https://drive.google.com/drive/folders/1aBtcqFRfFih6uF7bU4l2l_Q_w6_rcN95?usp=drive_link'
            };
            
            if (englishLabLinks[type]) {
                // Log English lab access
                UserLogger.logActivity('file_access', `Accessed English Lab ${type}`, currentCourse);
                window.open(englishLabLinks[type], '_blank', 'noopener,noreferrer');
            }
        }

        function openDriveLink(type) {
            const courseLinks = {
                'SWE0613-1121': {
                    books: 'https://drive.google.com/drive/folders/1K_obv2LUf7qpFCXDGj6bp0dAi-DytQrx?usp=drive_link',
                    notes: 'https://drive.google.com/drive/folders/1WwT0lgUm-LIxwUrzHmpdiR0HE6efXRM6?usp=drive_link',
                    questions: 'https://drive.google.com/drive/folders/1-WL990uxd5Nwg9fQG-YxCRGwLbWaTDGS?usp=sharing'
                },
                'SWE0541-1123': {
                    books: 'https://drive.google.com/drive/folders/1-nHSblj2qIA2HjUb-CvCDrno3rSq23PG?usp=sharing',
                    notes: 'https://drive.google.com/drive/folders/1MBxWRbY986QI_HUN68NdhWODCqG5aeKC?usp=drive_link',
                    questions: 'https://drive.google.com/drive/folders/1b4Gj3PcuyDpkypidrmFnPXoKAQTscQDz?usp=drive_link'
                },
                'EEE0712-1101W': {
                    books: 'https://drive.google.com/drive/folders/1soVr5Pvm0XxVbdmZQ8__mi4i0KzvRcif?usp=drive_link',
                    notes: 'https://drive.google.com/drive/folders/1IoE0CkqcSFJ6lIto15QrfPrj-Dt4nm16?usp=drive_link',
                    questions: 'https://drive.google.com/drive/folders/1QzF0LyyKm91h_A-g4v76QiZduiLyvamO?usp=drive_link'
                },
                'MAT0541-1105W': {
                    books: 'https://drive.google.com/drive/folders/1w3a5qZ0MNjGQEjiSAo5KzS0XzRC1kpxO?usp=drive_link',
                    notes: 'https://drive.google.com/drive/folders/1J8vGdQ5zajUT506Ypz7d-lNn-PFsdkfP?usp=drive_link',
                    questions: 'https://drive.google.com/drive/folders/14BRzI_2bt9uvOjjX-JnBCZo9WrJ8HTvS?usp=drive_link'
                },
                'ENG0231-1101W': {
                    books: 'https://drive.google.com/drive/folders/1PucU0pRUebH7ZiZNrVfF8fd_xuHrREbv?usp=sharing',
                    notes: 'https://drive.google.com/drive/folders/1vmb0OuiGiEZgIcPq-rVKZ8lZucWrcvie?usp=drive_link',
                    questions: 'https://drive.google.com/drive/folders/1ZE6CrBOWFpN5SkSXCQOxnaPgLN-f6_1k?usp=drive_link'
                }
            };
            
            // Default links for courses without specific folders
            const defaultLinks = {
                books: 'https://drive.google.com/drive/folders/your-books-folder-id',
                notes: 'https://drive.google.com/drive/folders/your-notes-folder-id',
                questions: 'https://drive.google.com/drive/folders/your-questions-folder-id'
            };
            
            const url = courseLinks[currentCourse] ? courseLinks[currentCourse][type] : defaultLinks[type];
            
            // Log file access
            const typeNames = { books: 'Books', notes: 'Notes', questions: 'Previous Questions' };
            UserLogger.logActivity('file_access', `Accessed ${typeNames[type] || type}`, currentCourse);
            
            window.open(url, '_blank', 'noopener,noreferrer');
        }

        function openYearQuestions(year) {
            // Year-wise question folders for First Year Semester 1
            const yearQuestions = {
                '2023': 'https://drive.google.com/drive/folders/1wn6KY31zZFjMNR_xhJN2mV72ZNJNhSrW?usp=drive_link',
                '2022': 'https://drive.google.com/drive/folders/1nXT5blynF4AOd5mL5aCwEXbwbYXon8cp?usp=drive_link',
                '2021': 'https://drive.google.com/drive/folders/1TnLtsiPZM13OUH2fdgqD5meIcICjVcZN?usp=drive_link',
                '2020': 'https://drive.google.com/drive/folders/1nuODYE9Sc5bZqqfDbSwvb-EGB8rMitcq?usp=drive_link'
            };
            
            if (yearQuestions[year]) {
                // Log year question access
                UserLogger.logActivity('file_access', `Accessed ${year} question papers`);
                window.open(yearQuestions[year], '_blank', 'noopener,noreferrer');
            }
        }

        // Log management functions
        function showLogs() {
            // Hide all other views
            document.getElementById('main-view').classList.add('hidden');
            document.getElementById('year-view').classList.add('hidden');
            document.getElementById('semester-view').classList.add('hidden');
            document.getElementById('course-view').classList.add('hidden');
            document.getElementById('logs-view').classList.remove('hidden');
            
            // Log viewing logs activity
            UserLogger.logActivity('admin', 'Viewed activity logs');
            
            // Populate logs table
            populateLogsTable();
            
            // Add event listeners for search and filter
            document.getElementById('logSearch').addEventListener('input', filterLogs);
            document.getElementById('logFilter').addEventListener('change', filterLogs);
        }

        function populateLogsTable(filteredLogs = null) {
            const logs = filteredLogs || UserLogger.getAllLogs();
            const tbody = document.getElementById('logsTableBody');
            const logCount = document.getElementById('logCount');
            
            logCount.textContent = logs.length;
            
            tbody.innerHTML = logs.map(log => `
                <tr class="hover:bg-gray-50">
                    <td class="px-4 py-3 text-gray-900">${new Date(log.timestamp).toLocaleString()}</td>
                    <td class="px-4 py-3 text-gray-900">${log.userName}</td>
                    <td class="px-4 py-3 text-gray-600">${log.userReg}</td>
                    <td class="px-4 py-3">
                        <span class="px-2 py-1 text-xs font-medium rounded-full ${getActionBadgeClass(log.action)}">
                            ${log.action}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-gray-600 max-w-xs truncate" title="${log.details}">${log.details}</td>
                    <td class="px-4 py-3 text-gray-600">${log.courseCode || '-'}</td>
                </tr>
            `).join('');
        }

        function getActionBadgeClass(action) {
            const classes = {
                'login': 'bg-green-100 text-green-800',
                'logout': 'bg-red-100 text-red-800',
                'navigation': 'bg-blue-100 text-blue-800',
                'course_access': 'bg-purple-100 text-purple-800',
                'file_access': 'bg-orange-100 text-orange-800',
                'admin': 'bg-gray-100 text-gray-800',
                'system': 'bg-yellow-100 text-yellow-800'
            };
            return classes[action] || 'bg-gray-100 text-gray-800';
        }

        function filterLogs() {
            const searchTerm = document.getElementById('logSearch').value.toLowerCase();
            const filterAction = document.getElementById('logFilter').value;
            
            let filteredLogs = UserLogger.getAllLogs();
            
            if (filterAction) {
                filteredLogs = filteredLogs.filter(log => log.action === filterAction);
            }
            
            if (searchTerm) {
                filteredLogs = filteredLogs.filter(log => 
                    log.userName.toLowerCase().includes(searchTerm) ||
                    log.userReg.toLowerCase().includes(searchTerm) ||
                    log.details.toLowerCase().includes(searchTerm) ||
                    log.courseCode.toLowerCase().includes(searchTerm)
                );
            }
            
            populateLogsTable(filteredLogs);
        }

        function clearLogs() {
            if (confirm('Are you sure you want to clear all logs? This action cannot be undone.')) {
                UserLogger.logs = [];
                UserLogger.saveLogs();
                UserLogger.logActivity('admin', 'Cleared all activity logs');
                populateLogsTable();
                alert('All logs have been cleared.');
            }
        }
    </script>

    <style>
        body {
            box-sizing: border-box;
        }
        
        .login-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'984a69cd162d3378',t:'MTc1ODgwMjE3My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
